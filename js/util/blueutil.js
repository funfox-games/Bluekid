import{collection,db,doc,FirebaseHelper,getDocs}from"./firebase.js";let pack_data=null,_data=await fetch("../../asset/blues.json"),cachedBlues=(pack_data=await _data.json(),null);export default function generateBlueSelection(i,p){return new Promise(async(e,a)=>{var c=[];let l=document.createElement("div"),n=(l.className="blue_section container",document.createElement("div"));function d(e,a){var t,n;c.includes(e)||c.includes("undefined")||(t="undefined",(n=document.createElement("h2")).style.marginTop="5px",null==e||null==pack_data.packs[e]?(n.innerHTML="Bugged Blues",c.push("undefined")):(n.innerHTML=pack_data.packs[e].display_name,c.push(e),t=e),p.append(n),(e=l.cloneNode(!0)).id=t,(null!=a?document.getElementById(a):p).append(e))}n.className="bluechar",n.innerHTML='<img src="../asset/char/blue_notexture.png" width="64" alt="blue">';var s,t=pack_data.blues,r=(Object.entries(t).forEach(([e,a])=>{var t;"//"!=e&&(d(a.pack),(t=n.cloneNode(!0)).id=e,t.setAttribute("relativeLocation",pack_data.blues[e].imgPath),null==pack_data.blues[e]?t.children[0].src="../asset/char/blue_broken.png":t.children[0].src="../asset/char/"+pack_data.blues[e].imgPath,(null==a.pack||null==a.pack||""==a.pack?document.getElementById("undefined"):document.getElementById(a.pack)).append(t))}),s=i.currentUser.uid,await new Promise(async(e,a)=>{var t,n;null!=cachedBlues?e(cachedBlues):(t=collection(db,"users",s,"blues"),t=await getDocs(t),n=[],t.forEach(e=>{var a=e.data(),e=e.id;n.push({id:e,data:a})}),e(cachedBlues=n))}));for(let e=0;e<r.length;e++){var u=r[e].id,o=r[e].data;if(!(o.amount<=0)){if("memes"==o.pack&&(o.pack="meme"),d(o.pack),null!=pack_data.blues[u]){let e="#000000";switch(pack_data.blues[u].rarity.toLocaleLowerCase()){case"common":e="#cfcfcf";break;case"uncommon":e="#0bd900";break;case"rare":e="#0090d9";break;case"epic":e="#ae00ff";break;case"lengendary":e="#ccb800";break;case"mystical":e="#00d0f0"}document.getElementById(u.toString()).style.backgroundColor=e,document.getElementById(u.toString()).style.border="2px solid "+e,document.getElementById(u.toString()).style.boxShadow="0px 0px 10px 2px "+e}null==document.getElementById(u)&&(d("undefined"),(o=n.cloneNode(!0)).id=u,null==pack_data.blues[u]?o.children[0].src="../asset/char/blue_broken.png":o.children[0].src="../asset/char/"+pack_data.blues[u].imgPath,document.getElementById("undefined").append(o)),document.getElementById(u.toString()).setAttribute("given","")}}e()})}