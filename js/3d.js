import*as THREE from"three";import{GLTFLoader}from"GLTFLoader";import{OrbitControls}from"OrbitControls";let gltf="../asset/cardboardbox.gltf";function setupWEBGLRenderer(e){var n=new THREE.WebGLRenderer({alpha:!0});return n.setSize(window.innerWidth,window.innerHeight),n.domElement.style.position="absolute",document.getElementById(e).appendChild(n.domElement),n}export default async function Init3DOpen(t,E){return new Promise(async(a,e)=>{let r=new THREE.Scene,n=new THREE.PerspectiveCamera(50,window.innerWidth/window.innerHeight,.1,1e3);var i=new GLTFLoader;let o=new THREE.Clock,l;i.load(gltf,function(e){e.animations;let o=e.scene;(new THREE.TextureLoader).load("../asset/bluekid_box.png",e=>{var n=new THREE.PlaneGeometry(5,.8),e=new THREE.MeshBasicMaterial({map:e,transparent:!0,side:THREE.FrontSide}),i=new THREE.Mesh(n,e),i=(i.scale.set(.75,.75,.75),i.receiveShadow=!0,i.position.z=1.01,o.children[0].add(i),new THREE.Mesh(n,e));i.scale.set(.75,.75,.75),i.position.z=-1.01,i.rotation.y=Math.PI,i.receiveShadow=!0,o.children[0].add(i)});var n=new THREE.PointLight(16777215,10,100),n=(n.position.z=-5,n.position.y=3,o.add(n),r.add(o),l=new THREE.AnimationMixer(o),e.animations),e=THREE.AnimationClip.findByName(n,"BoxAction"),i=THREE.AnimationClip.findByName(n,"FlapOneAction"),t=THREE.AnimationClip.findByName(n,"FlapTwoAction"),n=THREE.AnimationClip.findByName(n,"KnifAction"),e=l.clipAction(e),i=l.clipAction(i),t=l.clipAction(t),n=l.clipAction(n);e.setLoop(THREE.LoopOnce),i.setLoop(THREE.LoopOnce),t.setLoop(THREE.LoopOnce),n.setLoop(THREE.LoopOnce),E&&(e.timeScale=1.75,i.timeScale=1.75,t.timeScale=1.75,n.timeScale=1.75),e.play(),i.play(),t.play(),n.play(),setTimeout(()=>{a()},E?1650:3750)},void 0,function(e){console.log("Error loading gltf file:",e)});i=new THREE.HemisphereLight(16777215,0);r.add(i),n.position.set(0,3,5),n.rotation.x=-Math.PI/10,t.setAnimationLoop(function(){l&&l.update(o.getDelta()),t.render(r,n)})})}export{setupWEBGLRenderer};